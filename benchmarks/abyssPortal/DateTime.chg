DateTime Changes:

1) Add in local ariable for leapYearsBefore
2) Substitute global constants with their actual constant value